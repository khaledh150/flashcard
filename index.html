<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mental Arithmetic System</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@500;700&family=Nunito:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      width: 100vw; height: 100vh;
      background: #fff;
      font-family: 'Quicksand', 'Nunito', Arial, sans-serif;
      box-sizing: border-box;
      user-select: none;
      overflow: hidden;
    }
    body { position: relative; }

    /* Floating Logos */
    .logo-fixed, .logo-wk {
      position: fixed; z-index: 20;
      background: none !important; border-radius: 2vw;
      min-width: 54px; max-width: 120px; width: 13vw; height: auto;
      pointer-events: none; box-shadow: none !important;
      top: 2vw;
    }
    .logo-fixed { left: 2vw; }
    .logo-wk { right: 2vw; }
    @media (max-width: 700px) {
      .logo-fixed, .logo-wk { width: 20vw; min-width: 44px; max-width: 64px;}
    }

    /* Mascot (Floating Bottom Left) */
    .mascot-box {
      position: fixed; left: 0; bottom: 0; z-index: 19;
      padding: 0.5vw 0.3vw;
      pointer-events: none; user-select: none;
      background: none !important; box-shadow: none !important;
    }
    #nadamascot {
      width: 10vw; min-width: 40px; max-width: 72px;
      height: auto; pointer-events: none;
      animation: mascotFloat 3.7s ease-in-out infinite alternate, mascotWave 2.6s ease-in-out infinite;
      filter: drop-shadow(0 3px 10px rgba(120,180,255,0.08));
    }
    @keyframes mascotFloat { 0%{transform:translateY(0);} 50%{transform:translateY(-7px);} 100%{transform:translateY(0);} }
    @keyframes mascotWave  { 0%,100%{transform:rotate(-2deg);} 50%{transform:rotate(3deg);} }

    /* Main Centered Content */
    .main-content {
      width: 100vw; height: 100vh;
      display: flex; align-items: center; justify-content: center; flex-direction: column;
      position: relative; z-index: 1;
      background: none !important; box-shadow: none !important;
    }
    .main-centerer {
      flex: 1 1 0%; width: 100vw; height: 100vh;
      display: flex; align-items: center; justify-content: center; position: relative;
      background: none !important; box-shadow: none !important;
    }
    .number-wrapper {
      flex: 1; width: 100vw; height: 100vh;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      position: relative; pointer-events: none;
      background: none !important; box-shadow: none !important;
    }

    /* Flashing Numbers & Answer */
    #number, #answer {
      text-align: center; width: 100vw; max-width: 100vw; 
      font-weight: bold; line-height: 1.04;
      letter-spacing: 1vw; border-radius: 2vw;
      transition: color 0.13s;
      box-sizing: border-box;
      padding: 0.5vw 0; margin: 0;
      background: none !important; box-shadow: none !important;
      min-height: 1.1em; user-select: none;
      position: relative;
      left: 0; right: 0;
      top: 0; bottom: 0;
      margin: 0 auto;
      display: flex; align-items: center; justify-content: center;
    }
    #number {
      color: #3a21b3;
      font-size: clamp(250px, 1200vw, 40vw); /* GIANT */
      text-shadow: 0 3px 16px rgba(120,170,255,0.09);
      min-height: 1em; pointer-events: none;
    }
    .with-equal { display: flex; align-items: center; font-size: inherit;}
    .equal-sign {
      font-size: 1em; color: #ff0000; margin-left: 2vw; font-weight: 900; line-height: 1; display: inline-block;
      animation: pop 0.3s;
    }
    @keyframes pop { 0%{transform:scale(0.7);opacity:0.4;} 70%{transform:scale(1.3);opacity:1;} 100%{transform:scale(1);opacity:1;} }

    #answer {
      color: #ff0000;
      display: none;
      font-size: clamp(50px, 20vw, 23vw); /* HUGE */
      font-weight: 1100;
      z-index: 3;
      position: absolute;
      top: 60%;
      left: 0; right: 0;
      margin: auto;
      transform: translateY(-40%);
      background: none !important; box-shadow: none !important;
      pointer-events: none;
    }
    #equation {
      display: none;
      position: absolute; left: 0; right: 0; top: 50%; transform: translateY(-55%);
      font-size: clamp(32px, 5vw, 80px);
      font-family: inherit; color: #3b15a3; font-weight: bold; letter-spacing: 1vw;
      z-index: 3; opacity: 0; animation: eq-pop 0.6s cubic-bezier(.27,1.3,.28,.99) forwards;
      text-align: center; pointer-events: none; line-height: 1.1;
      width: 100vw; max-width: 100vw;
    }
    @keyframes eq-pop { 0%{transform:scale(0.8)translateY(-50%);opacity:0;} 60%{transform:scale(1.12)translateY(-55%);opacity:1;} 100%{transform:scale(1)translateY(-55%);opacity:1;} }

    /* Settings Page (rounded blue, soft style) */
    #firstPage {
      width: 100vw; text-align: center; margin-top: 10vh;
      margin-bottom: 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
      gap: 2vw;
    }
    #firstPage label {
      font-size: 1.2em; color: #2d49a3; font-weight: 700; margin: 0 0.5em 0 0;
    }
    #firstPage input[type="number"], #firstPage select {
      border: none;
      border-radius: 2em;
      padding: 0.42em 1.3em;
      font-size: 1.18em;
      font-family: inherit;
      font-weight: 600;
      margin: 0 1vw;
      background: #f0f8ff;
      box-shadow: 0 2px 16px rgba(85,180,255,0.06);
      color: #313169;
      transition: box-shadow 0.15s;
      outline: none;
    }
    #firstPage .radio-group label {
      color: #185bff; font-weight: 700; font-size: 1.04em; margin: 0 1vw;
    }
    #toggleButton {
      background: linear-gradient(90deg,#56c7fa 0,#349afd 100%);
      color: white; border: none; border-radius: 2.2em;
      font-size: 1.35em; font-weight: 700; padding: 0.38em 2.8em;
      box-shadow: 0 4px 28px rgba(90,180,255,0.18);
      cursor: pointer; transition: background 0.13s, box-shadow 0.15s, transform 0.09s;
      margin-top: 2vw; letter-spacing: 0.04em;
    }
    #toggleButton:hover, #toggleButton:focus {
      background: linear-gradient(90deg,#44b4fc 0,#2352c9 100%);
      box-shadow: 0 8px 26px rgba(85,180,255,0.19);
      transform: translateY(-3px) scale(1.03);
    }

    /* --- Floating BOTTOM BUTTONS --- */
    .bottom-buttons {
      position: fixed; left: 0; right: 0; bottom: 2vw; z-index: 300;
      display: flex; flex-direction: row; justify-content: center; align-items: center; gap: 2vw;
      pointer-events: none; /* only children active */
      background: none !important; box-shadow: none !important; border: none !important;
      width: 100vw; padding: 0; margin: 0; height: auto; min-height: 0;
    }
    .bottom-btn {
      pointer-events: all;
      background: linear-gradient(90deg,#56c7fa 0,#349afd 100%);
      color: white; border: none; border-radius: 2.2em;
      font-size: 1.24em; font-family: inherit; font-weight: 700;
      box-shadow: none !important; outline: none;
      letter-spacing: 0.04em; min-width: 86px; padding: 0.46em 2.3em;
      margin: 0; cursor: pointer; transition: background 0.14s, transform 0.12s;
      display: none; /* show only when active */
    }
    .bottom-btn.purple {
      background: linear-gradient(90deg,#a964fc 0,#7522d5 100%);
    }
    .bottom-btn.red {
      background: linear-gradient(90deg,#ff6060 0,#d32a2a 100%);
    }
    .bottom-btn:active { transform: scale(0.97);}
    .bottom-btn:focus, .bottom-btn:hover { filter: brightness(0.97); }
    @media (max-width: 700px) {
      .bottom-buttons { gap: 1.2vw; bottom: 1vw;}
      .bottom-btn { font-size: 1.07em; min-width: 61px; padding: 0.29em 1.2em;}
    }

    /* Get Ready Overlay */
.getready-overlay {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(255,255,255,0.88);
  z-index: 9000;
  display: none;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  transition: opacity 0.18s;
}
.getready-text, .getready-count {
  width: 100vw;
  text-align: center;
  font-family: 'Nunito', 'Quicksand', Arial, sans-serif;
  font-weight: 900;
  letter-spacing: 0.04em;
}
.getready-text {
  font-size: clamp(3rem, 10vw, 7rem);
  color: #8035d7;
  margin-bottom: 0.5em;
  margin-top: 0;
  transition: color 0.2s;
}
.getready-count {
  font-size: clamp(5rem, 18vw, 13rem);
  color: #2338e9;
  margin-top: 0;
  margin-bottom: 0;
  animation: pop 0.2s;
}
.getready-go {
  color: #23b15a;
  font-size: clamp(5rem, 18vw, 13rem);
  font-weight: 900;
  letter-spacing: 0.05em;
  margin-top: 0;
  margin-bottom: 0;
  animation: pop 0.4s;
}
@keyframes pop {
  0% { transform: scale(0.7); opacity: 0.5;}
  60% { transform: scale(1.18); opacity: 1;}
  100% { transform: scale(1); opacity: 1;}
}


    /* Hide scrollbars */
    ::-webkit-scrollbar { width: 0 !important }
    body { -ms-overflow-style: none; scrollbar-width: none; }
  </style>
</head>
<body>
  <!-- Floating Logos -->
  <img src="nada.png" alt="Logo" class="logo-fixed">
  <img src="wonderkids.png" alt="Wonder Kids Logo" class="logo-wk">
  <!-- Centered Main Content -->
  <div class="main-content">
    <div class="main-centerer">
      <div id="firstPage">
        <div style="margin-bottom:2vw;">
          <label for="speedInput">Speed</label>
          <input type="number" id="speedInput" value="1.0" min="0.3" max="5.0" step="0.1" />
          <label for="countInput">Num/set</label>
          <input type="number" id="countInput" value="5" min="1" max="20"/>
        </div>
        <div style="margin-bottom:2vw;">
          <label for="operation">Operation</label>
          <select id="operation">
            <option value="addsub" selected>Add / Subtract</option>
            <option value="multi">Multiply (ร)</option>
            <option value="divide">Divide (รท)</option>
          </select>
          <span class="radio-group" id="digitTypeGroup" style="display:inline-flex;">
            <label style="margin:0; color:#185bff;">
              <input type="radio" name="digitType" value="single" checked>Single Digit
            </label>
            <label style="margin:0; color:#185bff;">
              <input type="radio" name="digitType" value="double">2 Digits
            </label>
          </span>
        </div>
        <button id="toggleButton">START</button>
      </div>
      <div id="secondPage" style="display: none; width:100%;">
        <div class="number-wrapper">
          <div id="number"></div>
          <div id="answer"></div>
          <div id="equation"></div>
        </div>
      </div>
    </div>
  </div>
  <!-- Floating Bottom Buttons -->
  <div class="bottom-buttons">
    <button id="backButton" class="bottom-btn">Back</button>
    <button id="showAnswerButton" class="bottom-btn purple">Show Answer</button>
    <button id="nextButton" class="bottom-btn">Next Set</button>
  </div>
  <!-- Mascot floating -->
  <div class="mascot-box">
    <img src="nadamascot.png" id="nadamascot" alt="Mascot">
  </div>
  <!-- Sounds -->
  <audio id="tickSound" src="tick.wav" preload="auto"></audio>
  <audio id="dingSound" src="ding.wav" preload="auto"></audio>
  <audio id="getready321" src="getready321.wav" preload="auto"></audio>
  <audio id="startbuzz" src="startbuzz.wav" preload="auto"></audio>
  <!-- Overlay -->
  <div id="getreadyOverlay" class="getready-overlay">
    <div class="getready-text" id="getreadyText">Get Ready</div>
    <div class="getready-count" id="getreadyCount"></div>
  </div>
  <script>
    // --- DATA ---
    // --- DATA ---
function randomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
function generateRandomSets(numSets = 30, numbersPerSet = 9, mode = 'addsub', digitType = 'single') {
  const sets = [];
  for (let i = 0; i < numSets; i++) {
    let set = [], runningTotal = 0;
    if (mode === 'addsub') {
      let minN = digitType === "single" ? 1 : 10, maxN = digitType === "single" ? 9 : 99;
      for (let j = 0; j < numbersPerSet; j++) {
        let num;
        if (j === 0) { num = randomInt(minN, maxN); runningTotal += num; set.push(num); continue; }
        const op = Math.random() < 0.5 ? 1 : -1;
        num = op * randomInt(minN, maxN);
        if (op === -1 && runningTotal + num < 0) num = randomInt(minN, maxN);
        runningTotal += num; set.push(num);
      }
    } else if (mode === 'multi') {
      for (let j = 0; j < numbersPerSet; j++) { const a = randomInt(2, 9), b = randomInt(2, 9); set.push([a, b]); }
    } else if (mode === 'divide') {
      for (let j = 0; j < numbersPerSet; j++) { const b = randomInt(2, 9), a = b * randomInt(2, 9); set.push([a, b]); }
    }
    sets.push(set);
  }
  return sets;
}
// --- AUDIO ---
const tickSound = document.getElementById('tickSound');
const dingSound = document.getElementById('dingSound');
const getready321 = document.getElementById('getready321');
const startbuzz = document.getElementById('startbuzz');
function playTickSound() { try { tickSound.currentTime = 0; tickSound.play(); } catch (e) { } }
function playDingSound() { try { dingSound.currentTime = 0; dingSound.play(); } catch (e) { } }
function playGetReadySound() { try { getready321.currentTime = 0; getready321.play(); } catch (e) { } }
function playStartBuzz() { try { startbuzz.currentTime = 0; startbuzz.play(); } catch (e) { } }
// --- APP STATE ---
let sets = [], currentSetIndex = 0, currentNumberIndex = 0;
let countdownInterval, waitingForEnter = false, numbersToShow = 5, mode = 'addsub', digitType = 'single';
let lastNumber = null, lastDisplay = '', lastIndex = -1;
let getReadyTimeouts = [], nextSetTimeout = null, controlsLocked = false;
// --- DISPLAY ---
function displayNumber(isFirstRound) {
  if (controlsLocked) return;
  const numberDisplay = document.getElementById('number');
  const answerDisplay = document.getElementById('answer');
  const equationDisplay = document.getElementById('equation');
  const showAnswerButton = document.getElementById('showAnswerButton');
  const nextButton = document.getElementById('nextButton');
  answerDisplay.style.display = 'none'; equationDisplay.style.display = 'none';
  numberDisplay.style.color = (mode === "multi" || mode === "divide") ? "#a02de0" : "#185bff";
  numberDisplay.innerHTML = ""; showAnswerButton.style.display = 'none'; nextButton.style.display = 'none';
  if (typeof isFirstRound === 'undefined') isFirstRound = false;
  if (currentNumberIndex < numbersToShow) {
    let number, numberHtml;
    if (mode === "multi" || mode === "divide") {
      let [a, b] = sets[currentSetIndex][currentNumberIndex];
      if (currentNumberIndex === 0) { number = a; numberHtml = number; }
      else { let op = mode === "multi" ? "ร" : "รท"; number = b; numberHtml = `<span style="opacity:0.7;font-size:0.7em;margin-right:1vw;">${op}</span> ${number}`; }
    } else { number = sets[currentSetIndex][currentNumberIndex]; numberHtml = number; }
    if (currentNumberIndex === numbersToShow - 1) {
      numberHtml = `<span class="with-equal">${numberHtml}<span class="equal-sign">=</span></span>`;
    }
    numberDisplay.innerHTML = numberHtml;
    lastNumber = number; lastDisplay = numberHtml; lastIndex = currentNumberIndex;
    currentNumberIndex++;
    numberDisplay.animate([
      { transform: 'scale(0.88)', opacity: 0.7 },
      { transform: 'scale(1.14)', opacity: 1 },
      { transform: 'scale(1)', opacity: 1 }
    ], { duration: 280, easing: "cubic-bezier(.22,.93,.38,.99)" });
    playTickSound();
  } else {
    clearInterval(countdownInterval); showFullEquation();
    waitingForEnter = true; showAnswerButton.style.display = 'inline-block'; nextButton.style.display = 'none';
  }
}
function showFullEquation() {
  const equationDisplay = document.getElementById('equation');
  let eqStr = '';
  if (mode === "addsub") {
    for (let i = 0; i < numbersToShow; i++) {
      let n = sets[currentSetIndex][i];
      if (i === 0) eqStr += n; else eqStr += (n >= 0 ? ' + ' : ' - ') + Math.abs(n);
    }
    eqStr += ' <span style="color:#ff0000;font-size:1.2em;font-weight:900;">=</span>';
  } else if (mode === "multi") {
    for (let i = 0; i < numbersToShow; i++) {
      if (i === 0) eqStr += sets[currentSetIndex][i][0]; else eqStr += ' ร ' + sets[currentSetIndex][i][1];
    }
    eqStr += ' <span style="color:#ff0000;font-size:1.2em;font-weight:900;">=</span>';
  } else if (mode === "divide") {
    for (let i = 0; i < numbersToShow; i++) {
      if (i === 0) eqStr += sets[currentSetIndex][i][0]; else eqStr += ' รท ' + sets[currentSetIndex][i][1];
    }
    eqStr += ' <span style="color:#ff0000;font-size:1.2em;font-weight:900;">=</span>';
  }
  equationDisplay.innerHTML = eqStr;
  equationDisplay.style.display = 'block';
  equationDisplay.style.opacity = 0;
  equationDisplay.style.animation = 'none'; void equationDisplay.offsetWidth;
  equationDisplay.style.animation = null;
  document.getElementById('showAnswerButton').style.display = 'inline-block';
  document.getElementById('nextButton').style.display = 'none';
}
function showAnswer() {
  playDingSound();
  const numberDisplay = document.getElementById('number');
  const answerDisplay = document.getElementById('answer');
  const equationDisplay = document.getElementById('equation');
  let result = 0;
  if (mode === "multi") {
    result = sets[currentSetIndex].slice(0, numbersToShow).reduce((a, [b, c], i) => i === 0 ? b : a * c, null);
  } else if (mode === "divide") {
    result = sets[currentSetIndex].slice(0, numbersToShow).reduce((a, [b, c], i) => i === 0 ? b : a / c, null);
  } else {
    result = sets[currentSetIndex].slice(0, numbersToShow).reduce((a, b) => a + b, 0);
  }
  answerDisplay.textContent = result;
  answerDisplay.style.display = 'block';
  numberDisplay.innerHTML = "";
  equationDisplay.style.display = 'none';
  document.getElementById('showAnswerButton').style.display = 'none';
  document.getElementById('nextButton').style.display = 'inline-block';
  waitingForEnter = false;
}
// --- GET READY SEQUENCE ---
function clearGetReady() {
  getReadyTimeouts.forEach(t => clearTimeout(t));
  getReadyTimeouts = [];
  document.getElementById('getreadyOverlay').style.display = 'none';
  document.getElementById('getreadyText').style.display = '';
  document.getElementById('getreadyCount').style.display = '';
  document.getElementById('getreadyCount').textContent = '';
}
function startGetReadySequence(onDone) {
  clearGetReady();
  const overlay = document.getElementById('getreadyOverlay');
  const text = document.getElementById('getreadyText');
  const count = document.getElementById('getreadyCount');
  overlay.style.display = 'flex';
  text.style.display = '';
  count.style.display = '';
  text.textContent = 'Get Ready';
  count.textContent = '';
  playGetReadySound();
  getReadyTimeouts.push(setTimeout(() => { text.style.display = 'none'; count.style.display = ''; count.textContent = '3'; }, 900));
  getReadyTimeouts.push(setTimeout(() => { count.textContent = '2'; }, 1900));
  getReadyTimeouts.push(setTimeout(() => { count.textContent = '1'; }, 2900));
  getReadyTimeouts.push(setTimeout(() => {
    overlay.style.display = 'none';
    count.textContent = '';
    if (typeof onDone === 'function') onDone();
  }, 5500));
}
// --- NAV / PAGE LOGIC ---
function showFirstPage() {
  document.getElementById('firstPage').style.display = '';
  document.getElementById('secondPage').style.display = 'none';
  setBottomButtons(['none','none','none']);
}
function showSecondPage() {
  document.getElementById('firstPage').style.display = 'none';
  document.getElementById('secondPage').style.display = 'block';
  setBottomButtons(['back','none','none']);
}
function setBottomButtons(showList) {
  // showList = [back, showAnswer, next]
  document.getElementById('backButton').style.display = showList[0]==='back'?'inline-block':'none';
  document.getElementById('showAnswerButton').style.display = showList[1]==='show'?'inline-block':'none';
  document.getElementById('nextButton').style.display = showList[2]==='next'?'inline-block':'none';
}
// --- MAIN LOGIC ---
// Start button:
document.getElementById('toggleButton').addEventListener('click', () => {
  document.getElementById('firstPage').style.display = 'none';
  document.getElementById('secondPage').style.display = 'none';
  setBottomButtons(['none','none','none']);
  clearInterval(countdownInterval);
  clearGetReady();
  document.getElementById('getreadyOverlay').style.display = 'flex';

  numbersToShow = parseInt(document.getElementById('countInput').value);
  mode = document.getElementById('operation').value;
  digitType = document.querySelector('input[name="digitType"]:checked').value;
  sets = generateRandomSets(30, numbersToShow, mode, digitType);

  startGetReadySequence(() => {
    document.getElementById('getreadyOverlay').style.display = 'none';
    document.getElementById('secondPage').style.display = 'block';
    setBottomButtons(['back','none','none']);
    currentSetIndex = 0; currentNumberIndex = 0;
    document.getElementById('answer').style.display = 'none';
    document.getElementById('equation').style.display = 'none';
    document.getElementById('nextButton').style.display = 'none';
    document.getElementById('showAnswerButton').style.display = 'none';
    clearInterval(countdownInterval); currentNumberIndex = 0;
    displayNumber(true);
    countdownInterval = setInterval(displayNumber, parseFloat(document.getElementById('speedInput').value) * 1000);
    controlsLocked = false;
  });
});
function goBackToFirstPage() {
  clearGetReady(); clearInterval(countdownInterval);
  showFirstPage();
}
function nextSet() {
  if (controlsLocked) return;
  controlsLocked = true; playStartBuzz();
  document.getElementById('number').innerHTML = '';
  document.getElementById('answer').style.display = 'none';
  document.getElementById('equation').style.display = 'none';
  document.getElementById('nextButton').style.display = 'none';
  document.getElementById('showAnswerButton').style.display = 'none';
  nextSetTimeout = setTimeout(() => {
    currentSetIndex++;
    if (currentSetIndex >= sets.length) {
      sets = generateRandomSets(30, numbersToShow, mode, digitType);
      currentSetIndex = 0;
    }
    currentNumberIndex = 0;
    clearInterval(countdownInterval);
    displayNumber(true);
    countdownInterval = setInterval(displayNumber, parseFloat(document.getElementById('speedInput').value) * 1000);
    controlsLocked = false;
  }, 950);
}
document.getElementById('backButton').addEventListener('click', goBackToFirstPage);
document.getElementById('nextButton').addEventListener('click', nextSet);
document.getElementById('showAnswerButton').addEventListener('click', showAnswer);
document.getElementById('operation').addEventListener('change', function() {
  document.getElementById('digitTypeGroup').style.display = this.value === "addsub" ? "inline-flex" : "none";
});
document.addEventListener('keydown', function (event) {
  if (waitingForEnter && event.key === 'Enter') showAnswer();
});
showFirstPage();
  </script>
</body>
</html>
